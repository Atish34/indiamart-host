import{r as m,t as k,v as L,w as R,x as A,B as b,j as e,m as U}from"./index-a34ac5e4.js";import{u as H,c as _,a as u}from"./index.esm-df8c1c2c.js";import{C as B}from"./Container-16b23771.js";import{S as D}from"./Spinner-3bd5012a.js";import{C as j}from"./Card-32d7de1d.js";import{F as i}from"./FormControl-337777c8.js";import{B as o}from"./Button-9fc4f2d9.js";import"./ThemeProvider-48707fb0.js";import"./CardHeaderContext-c8dce645.js";import"./divWithClassName-324694fd.js";import"./index-813497d4.js";import"./Button-952ae1d0.js";const Y=()=>{const[N,f]=m.useState(!1),[l,h]=m.useState([]),[E,p]=m.useState([]),{data:g}=k(),[F,{isSuccess:y,isLoading:v}]=L(),[C,{isSuccess:P,isLoading:S}]=R(),[w,{isSuccess:I,isLoading:q}]=A(),[t,x]=m.useState(),n=H({enableReinitialize:!0,initialValues:{name:t?t.name:"",desc:t?t.desc:"",price:t?t.price:"",qty:t?t.qty:"",hero:t?t.hero:"",category:t?t.category:""},validationSchema:_({name:u().required("Enter name"),desc:u().required("Enter desc"),price:u().required("Enter price"),qty:u().required("Enter qty"),category:u().required("Enter category")}),onSubmit:(r,{resetForm:s})=>{if(t){const c=new FormData;for(const a in r)a!=="hero"&&c.append(a,r[a]);for(const a of l)c.append("remove",a);for(const a of r.hero)c.append("hero",a);w({_id:t._id,fd:c}),x(null),h([])}else{const c=new FormData;for(const a in r)a!=="hero"&&c.append(a,r[a]);for(const a of r.hero)c.append("hero",a);C(c)}p([]),s()}}),d=r=>U({"form-control my-2":!0,"is-invalid":n.touched[r]&&n.errors[r],"is-valid":n.touched[r]&&!n.errors[r]});return m.useEffect(()=>{P&&b.success("product create success")},[P]),m.useEffect(()=>{y&&b.success("product delete success")},[y]),e.jsxs(B,{children:[S||v||q?e.jsxs(e.Fragment,{children:["Please Wait ... ",e.jsx(D,{})," "]}):e.jsxs(j,{className:"mb-5",children:[e.jsx(j.Header,{children:"Product"}),e.jsx(j.Body,{children:e.jsxs("form",{onSubmit:n.handleSubmit,children:[e.jsx(i,{className:d("name"),placeholder:"Enter Product Name",...n.getFieldProps("name")}),e.jsx(i,{className:d("desc"),placeholder:"Enter Product Description",...n.getFieldProps("desc")}),e.jsx(i,{type:"number",className:d("price"),placeholder:"Enter Product Price",...n.getFieldProps("price")}),e.jsx(i,{type:"number",className:d("qty"),placeholder:"Enter Product Qty",...n.getFieldProps("qty")}),e.jsx(i,{className:d("category"),placeholder:"Enter Product category",...n.getFieldProps("category")}),t?e.jsxs(e.Fragment,{children:[t.hero.map(r=>e.jsx("div",{children:e.jsxs("div",{className:`${l.includes(r)&&"border border-danger my-2"} d-flex justify-content-between align-items-center px-4`,children:[e.jsx("img",{src:r,height:100,className:"me-2 rounded-3",alt:""}),l.includes(r)?e.jsx(o,{onClick:s=>h(l.filter(c=>r!==c)),variant:"dark",children:"cancel"}):e.jsx(o,{variant:"danger",onClick:s=>{l.includes(r)||h([...l,r])},children:"Remove"})]},r._id)})),N?e.jsxs(e.Fragment,{children:[e.jsx(i,{type:"file",multiple:!0,onChange:r=>{const s=[];for(const c of r.target.files)s.push(URL.createObjectURL(c));p(s),n.setFieldValue("hero",r.target.files)},className:d("hero"),placeholder:"Enter Product Hero"}),e.jsx(o,{onClick:r=>f(!1),variant:"dark",children:"cancel"})]}):e.jsx(o,{onClick:r=>f(!0),className:"my-3",children:"Add New Image"})]}):e.jsx(e.Fragment,{children:e.jsx(i,{type:"file",multiple:!0,onChange:r=>{const s=[];for(const c of r.target.files)s.push(URL.createObjectURL(c));n.setFieldValue("hero",r.target.files),p(s)},className:d("hero"),placeholder:"Enter Product Hero"})}),E.map(r=>e.jsx("img",{src:r,height:50,alt:""})),t?e.jsxs(e.Fragment,{children:[e.jsx(o,{type:"submit",variant:"warning",className:"w-100 btn-lg",children:"Update Product"}),e.jsx(o,{type:"button",onClick:r=>x(null),variant:"outline-dark",className:"w-100 btn-lg mt-3",children:"Cancel"})]}):e.jsx(o,{type:"submit",className:"w-100 btn-lg",children:"Add Product"})]})})]}),e.jsxs("table",{className:"table table-dark table-striped table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"name"}),e.jsx("th",{children:"desc"}),e.jsx("th",{children:"price"}),e.jsx("th",{children:"qty"}),e.jsx("th",{children:"hero"}),e.jsx("th",{children:"category"}),e.jsx("th",{children:"actions"})]})}),e.jsx("tbody",{children:g&&g.result.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:r.name}),e.jsx("td",{children:r.desc}),e.jsx("td",{children:r.price}),e.jsx("td",{children:r.qty}),e.jsx("td",{children:r.hero.map(s=>e.jsx("img",{src:s,height:50,className:"mx-2 rounded-2",alt:""},s))}),e.jsx("td",{children:r.category}),e.jsxs("td",{children:[e.jsx(o,{onClick:s=>x(r),className:"me-2",variant:"warning",children:"Edit"}),e.jsx(o,{className:"me-2",variant:"danger",onClick:s=>F(r._id),children:"Remove"})]})]},r._id))})]})]})};export{Y as default};
